<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countdown Timer</title>
    <style>
        body {
            background-color: #121212; /* Темный фон */
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        h1 {
            font-size: 36px;
            color: #FFD700; /* Золотистый цвет для главной задачи */
            margin-bottom: 20px;
        }
        .countdown {
            font-size: 28px;
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
            background: rgba(255, 215, 0, 0.2); /* Полупрозрачный фон для таймеров */
            display: inline-block;
        }
        .task {
            margin: 15px 0;
            font-size: 22px; /* Уменьшение шрифта подзадач */
            color: lightgray; /* Более светлый цвет для подзадач */
            display: flex;
            align-items: center; /* Центрирование содержимого */
            justify-content: center; /* Центрирование содержимого */
        }
        .checkbox {
            margin-right: 10px;
            cursor: pointer; /* Курсор как указатель */
        }
        .completed {
            text-decoration: line-through;
            color: gray;
        }
        .highlight {
            color: #FFD700; /* Золотистый цвет для главной задачи */
        }
        /* Добавление стилей для активного состояния чекбокса */
        input[type="checkbox"]:checked {
            accent-color: #FFD700; /* Цвет чекбокса при активном состоянии */
        }
        /* Анимация для таймеров */
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }
        .countdown {
            animation: pulse 1s infinite; /* Пульсация таймеров */
        }
    </style>
</head>
<body>

<h1>Отсчет до встречи</h1>
<div id="countdown-1" class="countdown"></div>

<h2 class="highlight">Главная задача</h2>

<div class="task">
    <input type="checkbox" class="checkbox" id="task-1" onchange="toggleTask(this, 'task-1-text', 'countdown-2')">
    <span id="task-1-text">Отправка СДЭК до 29 ноября</span>
    <div id="countdown-2" class="countdown"></div>
</div>
<div class="task">
    <input type="checkbox" class="checkbox" id="task-2" onchange="toggleTask(this, 'task-2-text', 'countdown-3')">
    <span id="task-2-text">Сбор вещей до 28 ноября</span>
    <div id="countdown-3" class="countdown"></div>
</div>
<div class="task">
    <input type="checkbox" class="checkbox" id="task-3" onchange="toggleTask(this, 'task-3-text', 'countdown-4')">
    <span id="task-3-text">Покупка билета до 5 ноября</span>
    <div id="countdown-4" class="countdown"></div>
</div>
<div class="task">
    <input type="checkbox" class="checkbox" id="task-4" onchange="toggleTask(this, 'task-4-text', 'countdown-5')">
    <span id="task-4-text">Купить чемодан до 3 ноября</span>
    <div id="countdown-5" class="countdown"></div>
</div>

<script>
    // Сохранение состояния чекбоксов в локальном хранилище
    function saveCheckboxState() {
        const checkboxes = document.querySelectorAll('.checkbox');
        checkboxes.forEach(checkbox => {
            localStorage.setItem(checkbox.id, checkbox.checked);
        });
    }

    // Восстановление состояния чекбоксов из локального хранилища
    function loadCheckboxState() {
        const checkboxes = document.querySelectorAll('.checkbox');
        checkboxes.forEach(checkbox => {
            const checked = localStorage.getItem(checkbox.id) === 'true';
            checkbox.checked = checked;
            toggleTask(checkbox, checkbox.nextElementSibling.id, checkbox.parentElement.lastElementChild.id);
        });
    }

    // Функция для вычисления времени до события
    function calculateCountdown(endTime, elementId, completed) {
        const now = new Date().getTime();
        const distance = endTime - now;

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        const countdownElement = document.getElementById(elementId);
        if (completed) {
            countdownElement.innerHTML = "Задача выполнена!";
        } else if (distance < 0) {
            countdownElement.innerHTML = "Время вышло!";
        } else {
            countdownElement.innerHTML = days + " дней " + hours + " часов "
                + minutes + " минут " + seconds + " секунд ";
        }
    }

    // Обновление таймера
    setInterval(() => {
        const endTime1 = new Date("2024-11-30T00:00:00").getTime();
        const endTime2 = new Date("2024-11-05T00:00:00").getTime();
        const endTime3 = new Date("2024-11-29T00:00:00").getTime();
        const endTime4 = new Date("2024-11-28T00:00:00").getTime();
        const endTime5 = new Date("2024-11-03T00:00:00").getTime();

        const completedTasks = [
            localStorage.getItem("task-1") === 'true',
            localStorage.getItem("task-2") === 'true',
            localStorage.getItem("task-3") === 'true',
            localStorage.getItem("task-4") === 'true',
        ];

        calculateCountdown(endTime1, "countdown-1", false);
        calculateCountdown(endTime2, "countdown-2", completedTasks[0]);
        calculateCountdown(endTime3, "countdown-3", completedTasks[1]);
        calculateCountdown(endTime4, "countdown-4", completedTasks[2]);
        calculateCountdown(endTime5, "countdown-5", completedTasks[3]);
    }, 1000);

    // Функция для обработки завершения задачи
    function toggleTask(checkbox, taskId, countdownId) {
        const taskText = document.getElementById(taskId);
        const countdownText = document.getElementById(countdownId);
        if (checkbox.checked) {
            taskText.classList.add('completed');
            countdownText.classList.add('completed');
            countdownText.innerHTML = "Задача выполнена!";
            localStorage.setItem(checkbox.id, 'true'); // Сохранение состояния в локальное хранилище
        } else {
            taskText.classList.remove('completed');
            countdownText.classList.remove('completed');
            countdownText.innerHTML = ""; // Очищаем текст при снятии галочки
            localStorage.setItem(checkbox.id, 'false'); // Обновление состояния в локальном хранилище
        }
        saveCheckboxState(); // Сохраняем состояние чекбоксов
    }

    // Загружаем состояние чекбоксов при загрузке страницы
    window.onload = loadCheckboxState;
</script>

</body>
</html>
